<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Melody FOR Autumn</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.92.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
      <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Melody FOR Autumn" />
      <link href="/index.xml" rel="feed" type="application/rss+xml" title="Melody FOR Autumn" />
      
    
    
    <meta property="og:title" content="Melody FOR Autumn" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://ex-melody.me/" />

<meta itemprop="name" content="Melody FOR Autumn">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Melody FOR Autumn"/>
<meta name="twitter:description" content=""/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Melody FOR Autumn
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          Melody FOR Autumn
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
 <article class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray">
    
  </article>
  
  
  
  
  
  
  
    
    

    <div class="pa3 pa4-ns w-100 w-70-ns center">
      
       
          <h1 class="flex-none">
            Recent Works
          </h1>
        

      

      <section class="w-100 mw8">
        
        
          <div class="relative w-100 mb4">
            
<article class="bb b--black-10">
  <div class="db pv4 ph3 ph0-l no-underline dark-gray">
    <div class="flex flex-column flex-row-ns">
      
      <div class="blah w-100">
        <h1 class="f3 fw1 athelas mt0 lh-title">
          <a href="/work/interruptedexception%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" class="color-inherit dim link">
            InterruptedException异常处理
            </a>
        </h1>
        <div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
          前置知识  InterruptedException代表在当前线程阻塞时，有其他线程调用了当前线程的interrupt()方法，当前线程收到了中断通知，中断标志位被设置为true。 interrupt()会将线程内的中断标志位更新为true，线程可自行检查标志位是否为true并结束线程（开发者自行编写代码，没有相关代码就不对中断通知做响应）。若标志位为true时，线程在执行阻塞方法（sleep(),wait()等），就会抛出InterruptedException。 抛出InterruptedException的同时会将线程中断标志位更新为false（若仅捕获该异常而不做处理，当前线程会失去响应外界中断通知的能力，无法通过中断标志位的变化察觉是否收到中断通知）。 InterruptedException异常会将处理标志位更新为false，是因为阻塞方法使用了Thread类的静态方法isInterrupted()检查当前标志位是否为true，该方法在检查标志位后就会将标志位更新为false。  处理方式 虽然大部分场景可能没有线程要响应外界中断通知的需求，但最好还是通过以下两种方式保留线程知晓并处理外界中断通知的能力。
 对外抛出不做额外封装的InterruptedException，由上层方法决定如何处理该异常，如果异常被抛出到线程之外，相当于线程响应中断通知直接结束了。 不能抛出异常的情况下，需要调用interrupt()方法将中断标志位更新为true，保留方法知晓外界中断通知并做响应处理的能力。线程可自定义代码根据中断标志位的状态判断是否收到中断通知，并决定要不要结束线程。  实验代码  public static void main(String[] args) {//对当前线程发出中断通知，实质上仅仅是将线程的中断标志位设置为true,需要线程根据中断标志位的状态做相应处理，线程自身并不会直接结束Thread.currentThread().interrupt();System.out.println(&quot;interrupt status is &quot; + Thread.currentThread().isInterrupted() +&quot; and Thread still alive&quot;);try {//sleep让线程阻塞，阻塞过程中发现中断标志位是true立刻抛出异常。Thread.currentThread().sleep(2000);} catch (InterruptedException e) {if (Thread.currentThread().isInterrupted()) {System.out.println(&quot;interrupt status now is true&quot;);} else {//阻塞方法抛出异常后，中断标志位发现已被更新为falseSystem.out.println(&quot;after throw exception,interrupt status now is false&quot;);}//重新设置标志位为true，保留线程根据标志位响应中断通知的能力Thread.currentThread().interrupt();}if (Thread.interrupted()) {System.out.println(&quot;set interrupt status as True&quot;);if (!
        </div>
          <a href="/work/interruptedexception%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
        
      </div>
    </div>
  </div>
</article>

          </div>
        
          <div class="relative w-100 mb4">
            
<article class="bb b--black-10">
  <div class="db pv4 ph3 ph0-l no-underline dark-gray">
    <div class="flex flex-column flex-row-ns">
      
      <div class="blah w-100">
        <h1 class="f3 fw1 athelas mt0 lh-title">
          <a href="/work/mysql%E4%BA%8B%E5%8A%A1%E4%B8%8D%E6%94%AF%E6%8C%81truncate%E5%91%BD%E4%BB%A4%E5%92%8C%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E4%B8%80%E8%B5%B7%E5%9B%9E%E6%BB%9A/" class="color-inherit dim link">
            MySQL事务不支持Truncate命令和其他操作一起回滚
            </a>
        </h1>
        <div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
          Data Manipulation Language (DML) 数据操作语言 （select，insert，update等，主要用于调整查询数据 ）
  Data Definition Language (DDL) 数据定义语言 （CREATE,TRUNCATE,DROP,ALTER等，主要用于调整数据库的定义结构等元数据 ）
根据https://dev.mysql.com/doc/refman/8.0/en/atomic-ddl.html文档， mysql提供了原子性的DDL语句，每次执行truncate操作都会直接提交COMMIT，要么成功要么失败，但无法与其他语句一起组合成为事务
  Atomic DDL is not transactional DDL. DDL statements, atomic or otherwise, implicitly end any transaction that is active in the current session, as if you had done a COMMIT before executing the statement. This means that DDL statements cannot be performed within another transaction, within transaction control statements such as START TRANSACTION &hellip; COMMIT, or combined with other statements within the same transaction.
        </div>
          <a href="/work/mysql%E4%BA%8B%E5%8A%A1%E4%B8%8D%E6%94%AF%E6%8C%81truncate%E5%91%BD%E4%BB%A4%E5%92%8C%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E4%B8%80%E8%B5%B7%E5%9B%9E%E6%BB%9A/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
        
      </div>
    </div>
  </div>
</article>

          </div>
        
          <div class="relative w-100 mb4">
            
<article class="bb b--black-10">
  <div class="db pv4 ph3 ph0-l no-underline dark-gray">
    <div class="flex flex-column flex-row-ns">
      
      <div class="blah w-100">
        <h1 class="f3 fw1 athelas mt0 lh-title">
          <a href="/work/ebayapi%E8%AF%B7%E6%B1%82%E6%96%B0%E5%A2%9E%E7%9A%84%E7%AD%BE%E5%90%8D%E6%9C%BA%E5%88%B6%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-java/" class="color-inherit dim link">
            ebayAPI请求新增的签名机制处理流程，java
            </a>
        </h1>
        <div class="f6 f5-l lh-copy nested-copy-line-height nested-links">
          部分站点因为新的安全政策，API请求需要额外新增四个header  x-ebay-signature-key将RSA公钥或ed25519公钥 转为jwe格式，公钥文件从ebay后续api下载 Content-Digest http请求body的内容摘要,使用SHA-256算法处理body生成摘要 Signature-Input 决定由哪些字段拼接为signature-base Signature 通过私钥对signature-base进行签名的得到 请求头的名字大小写不敏感  流程   通过ebay未来提供的api下载公钥私钥文件。
  将公钥转为jwe格式的字符串作为请求header x-ebay-signature-key。
  为api请求的body内容计算摘要content-digest，作为请求header Content-Digest
  ebay已经指定 header signature-Input 为sig1=(&ldquo;content-digest&rdquo; &ldquo;x-ebay-signature-key&rdquo; &ldquo;@method&rdquo; &ldquo;@path&rdquo; &ldquo;@authority&rdquo;);created=1658272908代表要根据content-digest，x-ebay-signature-key两个请求头的内容和http请求的&quot;@method&quot; &ldquo;@path&rdquo; &ldquo;@authority&quot;属性拼接signatureBase。 可直接通过URI对象获取这些@开头的属性。
URI uri = URI.create(url); String method = uri.getMethod();
  使用私钥文件为刚刚构造的signatureBase签名作为请求header Signature。
  拼接signature base的格式要求   详细的格式要求和签名机制可参考文档https://www.ietf.org/archive/id/draft-ietf-httpbis-message-signatures-11.html
  signature base每一行都是&quot;key&rdquo;: value\n的形式，key用&quot;&ldquo;括起来并且全部小写，冒号后附加单独的空格，value结束后换行。最后一行是@signature-params。 ebay指定了请求header signature-Input为
  signature-Input:sig1=(&quot;content-digest&quot; &quot;x-ebay-signature-key&quot; &quot;@method&quot; &quot;@path&quot; &quot;@authority&quot;);created=1658272908   created后面附加的是时间戳。
        </div>
          <a href="/work/ebayapi%E8%AF%B7%E6%B1%82%E6%96%B0%E5%A2%9E%E7%9A%84%E7%AD%BE%E5%90%8D%E6%9C%BA%E5%88%B6%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-java/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
        
      </div>
    </div>
  </div>
</article>

          </div>
        
      </section>

      
      <section class="w-100">
        <h1 class="f3">More</h1>
        
        
          <h2 class="f5 fw4 mb4 dib mr3">
            <a href="/work/%E6%9B%B4%E6%96%B0%E7%B1%BB%E7%9B%AE%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E5%A4%9A%E5%B1%9E%E6%80%A7/" class="link black dim">
              类目同步是否支持多属性
            </a>
          </h2>
        

        
        
          <a href="/work/" class="link db f6 pa2 br3 bg-mid-gray white dim w4 tc">All Works</a>
        
        </section>
      

      </div>
  

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://ex-melody.me" >
    &copy;  Melody FOR Autumn 2022 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
